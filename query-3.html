<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="apple-touch-icon" sizes="180x180" href="/detective-sql/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/detective-sql/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/detective-sql/favicon-16x16.png">
    <link rel="manifest" href="/detective-sql/site.webmanifest">

    <link rel="stylesheet" href="styles/main.css">

    <script src="https://kit.fontawesome.com/9477a9faa7.js" crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Poppins&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/animations/scale.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.59.4/codemirror.min.js"
        integrity="sha512-M1DpFDDFHNgGdgVsSkTP1sjfWC7mQFJM3obQo8gyKHbZmbmr95Kl9wPYa5T70BFQBi0+/TlcG6IZDLowJCbKBQ=="
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.59.4/codemirror.min.css"
        integrity="sha512-xIf9AdJauwKIVtrVRZ0i4nHP61Ogx9fSRAkCLecmE2dL/U8ioWpDvFCAy4dcfecN72HHB9+7FfQj3aiO68aaaw=="
        crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.59.4/theme/nord.min.css"
        integrity="sha512-sPc4jmw78pt6HyMiyrEt3QgURcNRk091l3dZ9M309x4wM2QwnCI7bUtsLnnWXqwBMECE5YZTqV6qCDwmC2FMVA=="
        crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.59.4/mode/sql/sql.min.js"
        integrity="sha512-dfObApt1XdGl62IJLrjbIOc9QtnRORA5TCwdnJkSj6C/KjwMz2L/Sc4WlcrgAuWoY+n5xTf6NMMojoUOlgwjug=="
        crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js"
        integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g=="
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css"
        integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg=="
        crossorigin="anonymous" />

    <title>Unauthorised Transaction: The Baker's Error</title>
</head>

<body>
    <div class="hero-slim">
        <h1>Unauthorised Transaction: The Baker's Error</h1>
        <p>So, Stephen Pecan-Brownie seems to have messed up big time. It appears he has shipped out some bread with the
            mask used to commit the crime baked into it! Stephen knows that it was sent out in batch number
            <code>"K50"</code> and that he noticed it was missing after packing up some <code>"sourdough"</code> bread.
            Guess we better find out where it went!</p>
    </div>

    <br>

    <div class="h5-wrap">
        <iframe src="https://h5p.org/h5p/embed/1127006" width="1090" height="677" frameborder="0"
            allowfullscreen="allowfullscreen"
            allow="geolocation *; microphone *; camera *; midi *; encrypted-media *"></iframe>
        <script src="https://h5p.org/sites/all/modules/h5p/library/js/h5p-resizer.js" charset="UTF-8"></script>
    </div>

    <div class="explan">
        <p>Look through the content above and make sure you understand the concept of querying for <span id="string_pop" class="tt">strings</span> and using the
            <code>AND</code> logic operator. Then, when you're ready, write a query below that returns the records the
            satisfy both of the search criteria:</p>
        <ol>
            <li>The data has a batch number of <code>K50</code></li>
            <li>The type of bread is <code>sourdough</code></li>
        </ol>
    </div>

    <style>
        .content-grid th:hover {
            cursor: default;
        }
    </style>

    <div class="content-grid">

        <div>
            <h2 class="center">Table Structure: <code>deliveries</code></h2>
            <div>
                <table class="structure">
                    <thead>
                        <tr>
                            <th>id <br><em>INTEGER</em></th>
                            <th>batch_no <br><em>VARCHAR(3)</em></th>
                            <th>bread_type <br><em>VARCHAR(30)</em></th>
                            <th>delivery_address <br><em>TEXT</em></th>
                        </tr>
                    </thead>
                    <tbody id="query-return">
                        <tr>
                            <td>&hellip;</td>
                            <td>&hellip;</td>
                            <td>&hellip;</td>
                            <td>&hellip;</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <style>
            #reload {
                font-size: 16px;
            }
        </style>
        <div class="query-region">
            <h2 class="center">Query Writer</h2>
            <div id="how-to" class="center">
                <p><em>How do I use this?</em></p>
            </div>
            <div id="error" class="center"></div>
            <textarea id="code" rows="3"></textarea>
            <div class="center"><button onclick="runQuery()" class="center" id="run-button"><i
                        class="fas fa-database"></i> Run Query</button>
                <button id="reload"><i class="fas fa-sync-alt"></i> Reload DB</button></div>
        </div>
    </div>

    <div id="test"></div>

    <br>
    <br>

    <script src="js/sql-wasm.js"></script>
    <script src="js/main.js"></script>
    <script>
        const exercise = new Exercise('bakery', "Village Hall, Council Plaza", "delivery_address",
            "narrative4.html");

        var editor = CodeMirror.fromTextArea(document.getElementById('code'), {
            lineNumbers: true,
            mode: 'text/x-sql',
            smartIndent: true,
            indentWithTabs: true,
            lineWrapping: false,
            scrollbarStyle: "null",
            theme: 'nord',
            viewportMargin: Infinity
        });

        function run(query) {
            var error_div = document.getElementById("error");
            error_div.innerHTML = "";
            try {
                var stmt = database.exec(query);
                return stmt;
            } catch (err) {
                var error_div = document.getElementById("error");
                error_div.innerHTML = "";
                console.log(err.message);
                var error_info = document.createElement("p");
                error_info.innerText = err.message;
                error_div.appendChild(error_info);
                return false;
            }
        }

        function runQuery() {
            var query = editor.getValue();
            var result = run(query);
            if (result !== false) {
                showResults(document.getElementById('test'), result, query);
            }
        }
    </script>
    <script>
        getDatabase('bakery.db');
        var reload = document.getElementById('reload');
        reload.addEventListener('click', function () {
            reloadDB('bakery.db');
        });
    </script>

    <script type="text/javascript">
        var modal = new tingle.modal({
            footer: false,
            closeMethods: ['overlay', 'escape', 'button'],
            closeLabel: 'Close'
        });

        modal.setContent(`
    <h2>Using the Query Writer</h2>
    <p>The query writer works a lot like the query builder, but you have to do more typing!</p>
    <p>Instead of tapping the buttons, it's time to use the skills you've learnt to write out your own queries. We use a special plugin to make writing code as realistic as possible. This means that you can lay your code out however you want! It can become really useful as your queries get bigger.</p>
    <p>Don't be afraid of jumping onto the next line by pressing <code>ENTER</code>. As long as you don't break up a word, you can spread your query out over several lines to make it more readable.</p>
    <p>When you're done, hit 'Run Query'. If you're just practicing SQL and accidentally delete the table, the database or alter the table schema, just press 'Reload DB'.</p>
    <p>Happy Querying!</p>
    `);

        var info_modal_trigger = document.getElementById('how-to');
        info_modal_trigger.addEventListener('click', function () {
            modal.open();
        });
    </script>

    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <script>
        tippy('#string_pop', {
            content: `A data value made up of ordered sequences of characters like "hello, world!".`,
            animation: 'scale'
        });
    </script>

</body>

</html>